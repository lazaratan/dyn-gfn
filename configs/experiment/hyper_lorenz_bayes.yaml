# @package _global_
#
# to execute this experiment run:
# python train.py experiment=linear_bayes

defaults:
  - override /model: bayesian_velocity
  - override /datamodule: unidentifiable_velocity.yaml
  - override /logger:
      - wandb
      - csv
  - override /trainer: gpu
name: "lorenz_hyper_gVI"

seed: 13

datamodule:
  batch_size: 100 #500
  p: 20 #20
  vars_to_deidentify: [0, 1]
  system: "lorenz"
  system_kwargs: { "F": 1.0 } # for lorenz
  T: 2
  train_val_test_split: [800, 100, 100]
  sigma: 0.0
  sd: 0.0
  delta_t: 0.1
  burn_in: 1000
  seed: 13

# best
model:
  lr: 1e-5
  alpha: 0.1
  l1_reg: 0.1
  kl_reg: 1
  svgd_reg: 0
  temperature: 0.01
  n_ens: 2500
  eval_batch_size: 2500
  k_hidden: 20
  hyper: "mlp" #["mlp", "invariant", "per_graph", "deepset"]
  hyper_hidden_dim: [64, 64, 64]
  bias: True

  optimizer: "adam"

trainer:
  max_epochs: 1000
  check_val_every_n_epoch: 5

logger:
  wandb:
    tags: ["hyper", "lorenz", "bayes", "${name}", "v14"]
